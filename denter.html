<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Enter</title>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="./header.css">
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    rel="stylesheet"
  />
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
 
   <style>
        body {
            background-color: aliceblue;
            margin: 0;
            padding: 20px;
        }
        #itemForm {
            background-color: whitesmoke;
            width: 60%;
            padding: 20px;
            margin: 20px auto;
            border-radius: 20px;
        }
        button {
            background-color: #5cb85c;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        input {
            width: 90%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            text-align: left;
            padding: 8px;
        }
        select{
            width: 90%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    </style>
</head>
<body>
   <nav class="sidebar">
  <h2>My Dashboard</h2>
  <a href="./dashboard.html" class="active"><i class="fas fa-home"></i> Home</a>
  <a href="./contact.html"><i class="fas fa-user"></i> Profile</a>
  <a href="./product.html"><i class="fas fa-box"></i> Add Product</a>
  <a href="./enter.html"><i class="fas fa-file-invoice"></i> View Bills</a>
  <a href="./grap.html"><i class="fas fa-chart-bar"></i> Reports</a>
  <a href="./denter.html"><i class="fas fa-clone"></i> Duplicate Bills</a>
</nav>
 <main class="main-content">

 <header class="navbar">
    <h1>Welcome Back!</h1>
    <div>
      <i class="bi bi-person-circle user-icon" id="userIcon" title="User Profile"></i>
    </div>

    <div class="user-profile-popup" id="userProfilePopup" aria-hidden="true">
      <h5>User Profile</h5>
      <ul>
        <li><i class="bi bi-telephone-fill"></i> +91 93479 89882</li>
        <li><i class="bi bi-envelope-fill"></i> nagir1090@gmail.com</li>
        <li><i class="bi bi-geo-alt-fill"></i> Kanakadri Palli (V), Kolimigundal (M), Kurnool (Dist) - 518123</li>
      </ul>
    </div>
  </header>

    <div class="container mt-4">
        <div class="d-flex justify-content-between mb-3">
          <!-- <button class="btn btn-outline-primary" onclick="home()">üè† Home</button> -->
          <button class="btn btn-success" onclick="reservation()">‚ûï Enter New Bill</button>
        </div>
      
        <form id="itemForm" class="card p-4 shadow-sm" style="display: none;">

          <h5 class="mb-3">üìã Bill Entry Form</h5>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Name</label>
              <input type="text" id="GuestName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Mobile Number</label>
              <input type="number" id="Moblienumber" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Date</label>
              <input type="date" id="checkindate1" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Address</label>
              <input type="text" id="address" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">GSTIN</label>
              <input type="text" id="noofperson" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">Product Name</label>
              <input type="text" id="productame" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">S/No</label>
              <input type="text" id="snumber" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">DP</label>
              <input type="text" id="dpayment" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">EMI</label>
              <input type="text" id="emipayment" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">Note</label>
              <input type="text" id="note" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">Product Rate</label>
              <input type="number" id="Tariff" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Product Quantity</label>
              <input type="number" id="productqty" class="form-control" required>
            </div>
            <div class="col-md-12">
              <label class="form-label">Payment Mode</label>
              <select id="paymentmode1" class="form-select">
                <option value="cash">Cash</option>
                <option value="card">Card</option>
                <option value="upi">UPI</option>
              </select>
            </div>
            <div class="col-12 text-end">
              <button type="submit" class="btn btn-primary">üíæ Save Bill</button>
            </div>
        </form>

        </div>
      </div>
      <table class="table table-striped table-hover mt-4">
        <thead class="table-dark">
            <tr>
                <th>Invoice No</th>
                <th>Name</th>
                <th>Mobile</th>
                <th>Date</th>
                <th>Address</th>
                <th>GST No</th>
                <th>Product Name</th>
                <th>S.No </th>
                <th>DP</th>
                <th>EMI</th>
                <th>Rate</th>
                <th>Qty</th>
                <th>Total</th>
                <th>Payment</th>
                <th>Note</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="itemList"></tbody>
      </table>
 </main>

    <script>
         
        const itemForm = document.getElementById('itemForm');
        const itemList = document.getElementById('itemList');
        let items1 = JSON.parse(localStorage.getItem('items1')) || [];
        function home() {
      window.location.href = "home.html";
    }
        function reservation(){
            document.getElementById('itemForm').style.display = "block";
        }

        function renderItems() {
            itemList.innerHTML = '';
            items1.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.sno1}</td>
                    <td>${item.name1}</td>
                    <td>${item.moblie1}</td>
                    <td>${item.checkindate1}</td>
                    <td>${item.address}</td>
                    <td>${item.noofperson1}</td>
                    <td>${item.productame1}</td>
                    <td>${item.sno}</td>
                    <td>${item.dp}</td>
                    <td>${item.emi}</td>
                    <td>${item.Tariff1}</td>
                    <td>${item.productqty1}</td>
                    <td>${item.total}</td>
                    <td>${item.paymentmode1}</td>
                    <td>${item.note}</td>
                   <td>
    <button onclick="editItem(${index})" class="btn btn-sm btn-warning me-1" title="Edit">
        <i class="bi bi-pencil-square"></i>
    </button>
    <button onclick="move(${index})" class="btn btn-sm btn-info me-1" title="Print Bill">
        <i class="bi bi-printer-fill"></i>
    </button>
    <button onclick="deleteItem(${index})" class="btn btn-sm btn-danger" title="Delete">
        <i class="bi bi-trash-fill"></i>
    </button>
</td>
                `;
                itemList.appendChild(row);
            });
        }
        // <button onclick="deleteItem(${index})">Delete</button>
        itemForm.addEventListener('submit', function(event) {
            event.preventDefault();
            document.getElementById('itemForm').style.display = "none";
            const checkindate = document.getElementById("checkindate1").value;
            const name = document.getElementById('GuestName').value;
            const moblie = document.getElementById('Moblienumber').value;
            const address = document.getElementById('address').value;
            const noofperson = document.getElementById("noofperson").value;
            const productame = document.getElementById('productame').value;
            const Tariff = document.getElementById("Tariff").value;
            const productqty = document.getElementById("productqty").value;
            const paymentmode = document.getElementById("paymentmode1").value;
            const sno = document.getElementById('snumber').value;
            const dp = document.getElementById("dpayment").value;
            const emi= document.getElementById("emipayment").value;
            const note = document.getElementById("note").value;
            
            const total=Tariff*productqty;
            let count = parseInt(localStorage.getItem('count')) || 0;
            count++;
            localStorage.setItem('count', count);
            const bookingdate = new Date().toLocaleDateString();
            items1.push({
                sno1: count,
                name1: name,
                moblie1: moblie,
                address: address,
                noofperson1: noofperson,
                checkindate1: checkindate,
                productame1: productame,
                Tariff1: Tariff,
                productqty1: productqty,
                paymentmode1: paymentmode,
                bookingdate1: bookingdate,
                total:total,
                sno:sno,
                dp:dp,
                emi:emi,
                note:note
            });
            localStorage.setItem('items1', JSON.stringify(items1));
            renderItems();
            itemForm.reset();
        });
        function editItem(index) {
            document.getElementById('itemForm').style.display = "block";
            const item = items1[index];
            document.getElementById('GuestName').value = item.name1;
            document.getElementById('Moblienumber').value = item.moblie1;
            document.getElementById('noofperson').value = item.noofperson1;
            document.getElementById('checkindate1').value = item.checkindate1;
            document.getElementById('address').value = item.address;
            document.getElementById('productame').value = item.productame1;
            document.getElementById('Tariff').value = item.Tariff1;
            document.getElementById('productqty').value = item.productqty1;
            document.getElementById('paymentmode1').value = item.paymentmode1;
            document.getElementById('snumber').value = item.sno;
            document.getElementById('dpayment').value = item.dp;
            document.getElementById('emipayment').value = item.emi;
            document.getElementById('note').value = item.note;
            items1.splice(index, 1);
            localStorage.setItem('items1', JSON.stringify(items1));
            renderItems();
        }
        function deleteItem(index) {
            if (confirm("Are you sure you want to delete this entry?")) {
                items1.splice(index, 1);
                localStorage.setItem('items1', JSON.stringify(items1));
                renderItems();
            }
        }
        function move(index) {
            const item = items1[index];
            alert(item.productame1);
            localStorage.setItem('invoice',item.sno1);
            localStorage.setItem('name', item.name1);
            localStorage.setItem('cell', item.moblie1);
            localStorage.setItem('date', item.checkindate1);
            localStorage.setItem('address', item.address);
            localStorage.setItem('gstno', item.noofperson1);
            localStorage.setItem('rate', item.Tariff1);
            localStorage.setItem('productame', item.productame1);
            localStorage.setItem('qty', item.productqty1);
            localStorage.setItem('paymentmode', item.paymentmode1);
            localStorage.setItem('total', item.total);
            localStorage.setItem('sno', item.sno);
            localStorage.setItem('dp', item.dp);
            localStorage.setItem('emi', item.emi);
            localStorage.setItem('note', item.note);
            window.location.href = "dbills.html";
        }
        renderItems();


         // profile
    const userIcon = document.getElementById('userIcon');
    const userProfilePopup = document.getElementById('userProfilePopup');

    userIcon.addEventListener('click', () => {
      const isVisible = userProfilePopup.style.display === 'block';
      userProfilePopup.style.display = isVisible ? 'none' : 'block';
      userProfilePopup.setAttribute('aria-hidden', isVisible);
    });

    // Close popup if clicking outside
    document.addEventListener('click', (event) => {
      if (!userIcon.contains(event.target) && !userProfilePopup.contains(event.target)) {
        userProfilePopup.style.display = 'none';
        userProfilePopup.setAttribute('aria-hidden', 'true');
      }
    });

    </script>
</body>
</html>
